# MVP: Регистрация идентичности и имени Логоса (Handle) — Spec v1
## Экосистема Логосов — Spec Driven Development
**Статус:** ✅ MVP Complete (Identity + Auth + Backup)  
**Последнее обновление:** 2024-12-17  
**Следующий этап:** `MVP_LOGOS_AI_SPEC_v1.md` — AI интеграция  
**Цель:** зафиксировать минимальный, принципиально децентрализованный сценарий "создать Логоса → получить имя → общаться", без требований к крипте/газу со стороны пользователя.

---

## ⚡ Implementation Status

| Компонент | Статус | Детали |
|-----------|--------|--------|
| NameRegistry V2 (on-chain) | ✅ LIVE | `0x87B9fD42553067BeBc2Abf42c7045C8F2F7D1A79` на Base |
| LogosAccountFactory | ✅ LIVE | `0x7553244FB04ff64EA0B86cA16F0427feb7F4E263` на Base |
| Handle Registration | ✅ Работает | Logos: `4DTOCH`, `8LXJXM`, `GUVUIK` созданы E2E |
| Backend API | ✅ Работает | create, check, resolve, DID, auth, chat endpoints |
| Web UI | ✅ Работает | Интеграция с контрактами через backend |
| **Auth Flow** | ✅ Работает | Challenge → Sign → Session |
| **Backup/Restore** | ✅ Работает | Export/Import `.logos` файлов |
| **UI Авторизации** | ✅ Работает | 3 состояния на главной странице |
| Treasury 2-of-3 | ⏸️ Pending | Требуются 3 уникальных адреса |
| Paymaster (gasless) | ⏸️ Pending | Зависит от Treasury |

**Deployment details:** см. `DEPLOYMENT.md`  

---

## 1. Принципы (сверка с манифестом)
- **Нет владельцев. Есть созидатели.**: никаких “админов”, выдающих доступ/имена/права вручную.
- **Открытость как абсолют.**: протоколы, форматы и спеки публичны; любую часть можно форкнуть и заменить своей реализацией.
- **Децентрализация как защита.**: глобальная уникальность имён обеспечивается on-chain реестром на Base; UI/хостинг — сменяемы.
- **Осознанность и ответственность.**: все правила проверяемы и формальны; ограничения — только алгоритмические (без ручного контроля).

См. также: `manifesto-ecosystem-logos-v2.1.md`, `LOGOS_ECOSYSTEM_SPECIFICATION.md`.

---

## 2. Термины
- **Handle / Имя Логоса**: человекочитаемый идентификатор вида `NEXO`.
- **Base36**: алфавит `A–Z` и `0–9`.
- **Controller**: адрес/аккаунт (смарт-аккаунт или EOA), который “контролирует” имя и действия Логоса через подписи.
- **Paymaster**: компонент account abstraction, оплачивающий газ за пользователя по прозрачным правилам.
- **Treasury**: on-chain казна, финансирующая paymaster (не привязана к одному человеку).

---

## 3. MVP Scope
### 3.1 Must-have
- Создание Логоса (контроллер + базовые метаданные).
- Автогенерация имени по умолчанию.
- Проверка уникальности имени в on-chain реестре Base.
- Регистрация имени on-chain без необходимости пользователю покупать крипту/газ.
- Базовое взаимодействие пользователя с Логосом (чат/диалог, без “миссий/инструментов” как обязательных).

### 3.2 Out of scope (MVP)
- Proof-of-Personhood (PoP), биометрия, KYC.
- Наследование/социальное восстановление на уровне протокола (Phase 2).
- Маркетплейс миссий, escrow, контракты, репутация (Phase 2+).
- Полноценная токеномика/оплата QI в UX (может появиться позже).

---

## 4. Правила имени (Handle Rules)
- **Длина:** 4–10 символов (включительно).
- **Алфавит:** только `A–Z` и `0–9`.
- **Нормализация:** приводить к uppercase.
- **Уникальность:** глобально, on-chain в сети Base (mainnet).
- **Непередаваемость:** имя не является рыночным активом в MVP (transfer запрещён на уровне контракта/реестра).
- **Без “политик привилегий”:** нет “элитных/премиум” классов, whitelist, аукционов, ручных модераций.

---

## 5. UX (то, что видит пользователь)
- Везде отображается **только handle** (например, `NEXO`).
- DID/версии/адреса/chainId скрыты в “Advanced” или не показываются вовсе в MVP.

---

## 6. Имя по умолчанию
- **Дефолтная длина:** 6 символов.
- **Генерация:** детерминированно/локально из публичного идентификатора контроллера (например, хеш → Base36), затем проверка занятости и при необходимости повтор/варианты.
- **Цель:** избежать ощущения “центральной выдачи”, при этом обеспечить быстрый старт.

---

## 7. On-chain компоненты (концептуально)
### 7.1 Реестр имён (Name Registry)
**Назначение:** хранить и доказывать соответствие `handle → controller`.

Минимальные требования к данным:
- `handleHash → controllerAddress`
- (опционально) указатель на документ/метаданные (URI/хеш) — не обязателен для MVP

Операции:
- `isAvailable(handle)` / эквивалент чтения состояния
- `register(handle, controller)` — единожды для свободного handle

Непередаваемость:
- transfer/перепродажа на уровне протокола отключены (чтобы не создавать модель присвоения).

### 7.2 Treasury (казна) и multisig
**Решение MVP:** Treasury под управлением **2-of-3 мультисиг** (несколько созидателей).

Требования:
- не “один человек”;
- адреса участников публичны (прозрачность);
- правила расходования формальны: финансирование paymaster и инфраструктуры регистрации.

### 7.3 Paymaster (газ-абстракция)
**Решение MVP:** paymaster оплачивает газ только для операции регистрации имени.

Требования:
- никакого ручного allowlist/ban по пользователям;
- ограничения только алгоритмические и минимальные (например, по типу операции и лимиту газа).

---

## 8. Off-chain компоненты (концептуально)
- **Creator Console (Web):** UI для создания Логоса, выбора/замены handle, чат с Логосом.
- **Identity Service (MVP-lite):** сервисная логика вокруг контроллера/метаданных и резолвинга имени через on-chain реестр. Не является “реестром пользователей”.
- **LLM Gateway:** гибридная схема (через `llm.nlplay.ai` или BYOK), но это за рамками данной спеки (относим к отдельному спеку “Chat/LLM”).

---

## 9. User Flow (MVP)
### 9.1 Создание Логоса
1) Пользователь нажимает “Создать Логоса”.
2) Создаётся контроллер Логоса (точный тип контроллера уточняется отдельным ADR; в MVP UI не раскрывает детали).
3) Генерируется default handle (6 символов).
4) UI показывает: “Твой Логос: `<HANDLE>`”.

### 9.2 Смена имени пользователем (опционально)
1) Пользователь вводит желаемое имя (например, `NEXO`).
2) UI проверяет доступность on-chain (`isAvailable`).
3) Если занято — UI предлагает 3–5 вариантов (например, `NEXO1`, `NEXO2`, `NEXO9`) и/или просит ввести другое.
4) Если свободно — выполняется `register(handle, controller)`:
   - транзакция отправляется через AA,
   - gas оплачивает paymaster.
5) UI фиксирует: “Твой Логос: `NEXO`”.

### 9.3 Взаимодействие
- Пользователь открывает чат и общается с Логосом.

---

## 10. Безопасность и анти‑злоупотребления (в рамках ценностей)
- **Без ручного контроля.** Никаких модераторов/админов, выбирающих “кому можно”.
- **Анти‑спам через экономику сети и paymaster‑ограничения по типу операций.**
- **Не требуем PoP** в MVP, но допускаем расширение позже (через отдельный слой аттестаций).

---

## 11. Acceptance Criteria (готово, если…)
- Пользователь может создать Логоса и получить default handle за одну сессию.
- Пользователь может заменить handle на желаемый, если он свободен, с on-chain проверкой.
- Регистрация handle проходит без покупки крипты пользователем (paymaster оплачивает gas).
- Пользователь видит только handle (`NEXO`), без DID-версий и блокчейн-деталей.

---

## 12. ADR ссылки (что нужно утвердить далее)
- **ADR: тип контроллера Логоса** (EOA vs smart account / AA) — отдельный документ.
- **ADR: формат DID/resolution** (публичный вид vs внутренний) — отдельный документ.
- **ADR: модель финансирования paymaster** (первичная казна, пополнение, прозрачные правила) — отдельный документ.


